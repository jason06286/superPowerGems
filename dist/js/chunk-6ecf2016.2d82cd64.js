(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ecf2016"],{4438:function(e,t,c){"use strict";c.r(t);c("b0c0"),c("b64b");var a=c("7a23"),n=Object(a["U"])("data-v-550f76f0");Object(a["z"])("data-v-550f76f0");var r=Object(a["i"])("div",{class:"bg-dark",style:{height:"68px"}},null,-1),o={class:"bg-white container-lg",style:{"min-height":"calc(100vh - 212px)"}},s={class:"py-5 p-lg-5"},l={key:0,class:"cart-content"},i=Object(a["i"])("p",{class:"mb-0 fs-4"},"購物車內無東西",-1),u=Object(a["h"])("請選購商品"),b={class:"row"},d={key:0,class:"col-md-6 col-12"},j=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"}," 購物車內容 ",-1),O={class:"table text-center table-responsive-lg"},p=Object(a["i"])("thead",null,[Object(a["i"])("tr",{class:"table-dark"},[Object(a["i"])("th",{scope:"col"}),Object(a["i"])("th",{scope:"col"},"商品名稱"),Object(a["i"])("th",{scope:"col",width:"120"},"數量"),Object(a["i"])("th",{scope:"col",class:"text-end"},"小計")])],-1),m={key:0,class:"btn btn-outline-danger btn-sm",type:"button",disabled:""},f=Object(a["i"])("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),h=Object(a["i"])("span",{class:"visually-hidden"},"Loading...",-1),v=Object(a["i"])("i",{class:"bi bi-trash-fill"},null,-1),g={class:"align-middle"},y={class:"align-middle"},w={class:"input-group input-group-sm"},k={class:"align-middle text-end"},x={class:"text-danger"},C=Object(a["i"])("td",{colspan:"3",class:"text-end"},"折扣優惠",-1),V={class:"line-through text-end"},E=Object(a["i"])("td",{colspan:"3",class:"text-end"},"總金額",-1),q={class:"text-end"},S={key:0,class:"mb-3 input-group"},U={class:"col-md-6 col-12"},_={key:0},F=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 收件人資訊"),Object(a["i"])("span",{class:"text-danger fs-4 ms-2"},"(必填)")],-1),Q={class:"mb-3 form-group"},I=Object(a["i"])("label",{for:"name",class:"mb-2"},"聯絡人",-1),B={class:"mb-3 form-group"},D=Object(a["i"])("label",{for:"email",class:"mb-2"},"信箱",-1),L={class:"mb-3 form-group"},P=Object(a["i"])("label",{for:"tel",class:"mb-2"},"電話",-1),$=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 配送資訊"),Object(a["i"])("span",{class:"text-danger fs-4 ms-2"},"(必填)")],-1),N={class:"mb-3 form-group"},A=Object(a["i"])("label",{for:"address",class:"mb-2"},"地址",-1),J={class:"mb-3 form-group"},z=Object(a["i"])("h4",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 留言"),Object(a["i"])("span",{class:"text-secondary fs-5 ms-2"},"(選填)")],-1),M=Object(a["i"])("label",{for:"message",class:"mb-2"},"留言",-1),G={class:"d-flex justify-content-end"},H=Object(a["h"])("繼續購物"),K={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},R=Object(a["h"])(" 送出訂單 ");Object(a["x"])();var T=n((function(e,t,c,T,W,X){var Y,Z,ee,te,ce,ae,ne,re,oe=Object(a["F"])("router-link"),se=Object(a["F"])("Field"),le=Object(a["F"])("ErrorMessage"),ie=Object(a["F"])("Form");return Object(a["w"])(),Object(a["e"])(a["a"],null,[r,Object(a["i"])("div",o,[Object(a["i"])("div",s,[0===(null===(Y=T.carts.arr)||void 0===Y||null===(Z=Y.carts)||void 0===Z?void 0:Z.length)?(Object(a["w"])(),Object(a["e"])("div",l,[i,Object(a["i"])(oe,{to:"/frontDesk/products",class:"d-block text-orange fs-4"},{default:n((function(){return[u]})),_:1})])):Object(a["f"])("",!0),Object(a["i"])("div",b,[0!==(null===(ee=T.carts.arr)||void 0===ee||null===(te=ee.carts)||void 0===te?void 0:te.length)?(Object(a["w"])(),Object(a["e"])("div",d,[j,Object(a["i"])("table",O,[p,Object(a["i"])("tbody",null,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["D"])(T.carts.arr.carts,(function(t){return Object(a["w"])(),Object(a["e"])("tr",{key:t.id},[Object(a["i"])("td",null,[T.isLoading===t.id?(Object(a["w"])(),Object(a["e"])("button",m,[f,h])):(Object(a["w"])(),Object(a["e"])("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(c){return e.delProduct(t)}},[v],8,["onClick"]))]),Object(a["i"])("td",g,Object(a["I"])(t.product.title),1),Object(a["i"])("td",y,[Object(a["i"])("div",w,[Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:T.isChangeQty}],type:"button",onClick:function(c){return e.addQty(t)}}," + ",10,["onClick"]),Object(a["S"])(Object(a["i"])("input",{type:"number",class:"text-center form-control",min:"1",disabled:"","onUpdate:modelValue":function(e){return t.qty=e}},null,8,["onUpdate:modelValue"]),[[a["N"],t.qty,void 0,{number:!0}]]),Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:t.qty<=1||T.isChangeQty}],type:"button",onClick:function(c){return e.minusQty(t)}}," - ",10,["onClick"])])]),Object(a["i"])("td",k," $ "+Object(a["I"])(T.currency(t.total)),1)])})),128))]),Object(a["i"])("tfoot",null,[Object(a["S"])(Object(a["i"])("tr",x,[C,Object(a["i"])("td",V," $ "+Object(a["I"])(T.currency(T.carts.arr.total-T.carts.arr.final_total)),1)],512),[[a["O"],T.carts.arr.total>T.carts.arr.final_total]]),Object(a["i"])("tr",null,[E,Object(a["i"])("td",q," $ "+Object(a["I"])(T.currency(T.carts.arr.final_total)),1)])])]),0!=(null===(ce=T.carts.arr)||void 0===ce||null===(ae=ce.carts)||void 0===ae?void 0:ae.length)?(Object(a["w"])(),Object(a["e"])("div",S,[Object(a["S"])(Object(a["i"])("input",{type:"text",class:"form-control",placeholder:"請輸入優惠券代碼","aria-label":"請輸入優惠券代碼","aria-describedby":"button-addon2","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.coupon=t})},null,512),[[a["N"],e.coupon]]),Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:""===e.coupon}],type:"button",id:"button-addon2",onClick:t[2]||(t[2]=function(){return e.useCoupon&&e.useCoupon.apply(e,arguments)})}," 套用優惠券 ",2)])):Object(a["f"])("",!0)])):Object(a["f"])("",!0),Object(a["i"])("div",U,[0!=(null===(ne=T.carts.arr)||void 0===ne||null===(re=ne.carts)||void 0===re?void 0:re.length)?(Object(a["w"])(),Object(a["e"])("div",_,[F,Object(a["i"])(ie,{onSubmit:e.onSubmit},{default:n((function(c){var r=c.errors;return[Object(a["i"])("div",Q,[I,Object(a["i"])(se,{id:"name",name:"聯絡人",type:"text",class:["form-control",{"is-invalid":r["聯絡人"]}],placeholder:"請輸入聯絡人",rules:"required",modelValue:e.user.user.name,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.user.user.name=t})},null,8,["class","modelValue"]),Object(a["i"])(le,{name:"聯絡人",class:"invalid-feedback"})]),Object(a["i"])("div",B,[D,Object(a["i"])(se,{id:"email",name:"信箱",type:"email",class:["form-control",{"is-invalid":r["信箱"]}],placeholder:"請輸入信箱",rules:"email|required",modelValue:e.user.user.email,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.user.user.email=t})},null,8,["class","modelValue"]),Object(a["i"])(le,{name:"信箱",class:"invalid-feedback"})]),Object(a["i"])("div",L,[P,Object(a["i"])(se,{id:"tel",name:"電話",type:"tel",class:["form-control",{"is-invalid":r["電話"]}],placeholder:"請輸入電話",rules:e.isPhone,modelValue:e.user.user.tel,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.user.user.tel=t})},null,8,["class","rules","modelValue"]),Object(a["i"])(le,{name:"電話",class:"invalid-feedback"})]),$,Object(a["i"])("div",N,[A,Object(a["i"])(se,{id:"address",name:"地址",type:"text",class:["form-control",{"is-invalid":r["地址"]}],placeholder:"請輸入地址",rules:"required",modelValue:e.user.user.address,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.user.user.address=t})},null,8,["class","modelValue"]),Object(a["i"])(le,{name:"地址",class:"invalid-feedback"})]),Object(a["i"])("div",J,[z,M,Object(a["S"])(Object(a["i"])("textarea",{class:"form-control",id:"message",placeholder:"有什麼話想對我們說呢?",rows:"3","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.message=t})},null,512),[[a["N"],e.message]])]),Object(a["i"])("div",G,[Object(a["i"])(oe,{type:"button",class:"btn btn-secondary me-3",to:"/frontDesk/products"},{default:n((function(){return[H]})),_:1}),Object(a["i"])("button",{class:["btn btn-primary",{"not-allowed":Object.keys(e.user.user).length<4}],type:"submit"},["submit"===T.isLoading?(Object(a["w"])(),Object(a["e"])("span",K)):Object(a["f"])("",!0),R],2)])]})),_:1},8,["onSubmit"])])):Object(a["f"])("",!0)])])])])],64)})),W=c("5530"),X=(c("99af"),c("bc3a")),Y=c.n(X),Z=c("1336"),ee=c("cfb9"),te=c("98e4"),ce=c("6c02"),ae={setup:function(){var e=Object(ce["d"])(),t=Object(a["A"])({arr:[]}),c=Object(a["B"])(""),n=Object(a["B"])(!1);function r(){var e=Object(a["B"])(""),r=function(){var e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart");Y.a.get(e).then((function(e){e.data.success?t.arr=e.data.data:console.error=function(){throw new Error(e.data.message)}})).catch((function(e){console.error=function(){throw new Error(e)}}))},o=function(e){c.value=e.id;var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart/").concat(e.id);Y.a.delete(t).then((function(e){e.data.success?(ee["a"].emit("update-cart"),r(),c.value=""):console.error=function(){throw new Error(e.data.message)},Object(te["a"])(e,"刪除商品")})).catch((function(e){console.error=function(){throw new Error(e)}}))},s=function(e,t){n.value=!0;var c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart/").concat(t);Y.a.put(c,{data:{product_id:t,qty:e}}).then((function(e){e.data.success?(n.value=!1,ee["a"].emit("update-cart"),r()):console.error=function(){throw new Error(e.data.message)},Object(te["a"])(e,"修改商品")})).catch((function(e){console.error=function(){throw new Error(e)}}))},l=function(){var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/coupon");Y.a.post(t,{data:{code:e.value}}).then((function(e){e.data.success?(ee["a"].emit("update-cart"),r()):console.error=function(){throw new Error(e.data.message)},Object(te["a"])(e,"套用優惠券")})).catch((function(e){console.error=function(){throw new Error(e)}}))};return Object(a["t"])((function(){r()})),{coupon:e,getCarts:r,delProduct:o,editCart:s,useCoupon:l}}function o(){var e=r(),t=e.editCart,c=function(e){var c=e.qty+1;t(c,e.id)},a=function(e){var c=e.qty-1;t(c,e.id)};return{addQty:c,minusQty:a}}function s(){var t=Object(a["A"])({user:{}}),n=Object(a["B"])(""),r=function(e){var t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},o=function(){c.value="submit";var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/order");Y.a.post(a,{data:{user:t.user,message:n.value}}).then((function(t){c.value="",t.data.success?(e.push("/frontDesk/pay/".concat(t.data.orderId)),ee["a"].emit("update-cart")):console.error=function(){throw new Error(t.data.message)}})).catch((function(e){console.error=function(){throw new Error(e)}}))};return{user:t,message:n,isPhone:r,onSubmit:o}}return Object(W["a"])(Object(W["a"])(Object(W["a"])({carts:t,isChangeQty:n,isLoading:c,currency:Z["a"]},r()),o()),s())}};c("d174");ae.render=T,ae.__scopeId="data-v-550f76f0";t["default"]=ae},b0c0:function(e,t,c){var a=c("83ab"),n=c("9bf2").f,r=Function.prototype,o=r.toString,s=/^\s*function ([^ (]*)/,l="name";a&&!(l in r)&&n(r,l,{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(e){return""}}})},bb54:function(e,t,c){},d174:function(e,t,c){"use strict";c("bb54")}}]);
//# sourceMappingURL=chunk-6ecf2016.2d82cd64.js.map