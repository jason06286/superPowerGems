(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f9e9ce84"],{4438:function(e,t,c){"use strict";c.r(t);c("b0c0"),c("b64b");var a=c("7a23"),n=Object(a["U"])("data-v-4b2e9600");Object(a["z"])("data-v-4b2e9600");var s=Object(a["i"])("div",{class:"bg-dark",style:{height:"68px"}},null,-1),r={class:"bg-white container-lg",style:{"min-height":"calc(100vh - 124px)"}},o={class:"py-5 bg-white p-lg-5"},l=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},"購屋車內容",-1),i={key:0,class:"cart-content"},u=Object(a["i"])("p",{class:"mb-0 fs-5"},"購物車內無東西",-1),b=Object(a["h"])("選購商品"),d={key:1,class:"table text-center table-responsive-lg"},j=Object(a["i"])("thead",null,[Object(a["i"])("tr",{class:"table-dark"},[Object(a["i"])("th",{scope:"col"}),Object(a["i"])("th",{scope:"col"},"商品名稱"),Object(a["i"])("th",{scope:"col",width:"120"},"數量"),Object(a["i"])("th",{scope:"col",class:"text-end"},"小計")])],-1),O={key:0,class:"btn btn-outline-danger btn-sm",type:"button",disabled:""},p=Object(a["i"])("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),m=Object(a["i"])("span",{class:"visually-hidden"},"Loading...",-1),f=Object(a["i"])("i",{class:"bi bi-trash-fill"},null,-1),h={class:"align-middle"},v={class:"align-middle"},g={class:"input-group input-group-sm"},y={class:"align-middle text-end"},k={class:"text-danger"},x=Object(a["i"])("td",{colspan:"3",class:"text-end"},"折扣優惠",-1),w={class:"line-through text-end"},C=Object(a["i"])("td",{colspan:"3",class:"text-end"},"總金額",-1),V={class:"text-end"},q={key:2,class:"mb-3 input-group"},S={key:3},U=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 收件人資訊"),Object(a["i"])("span",{class:"text-danger fs-4 ms-2"},"(必填)")],-1),_={class:"mb-3 form-group"},F=Object(a["i"])("label",{for:"name",class:"mb-2"},"聯絡人",-1),Q={class:"mb-3 form-group"},I=Object(a["i"])("label",{for:"email",class:"mb-2"},"信箱",-1),B={class:"mb-3 form-group"},D=Object(a["i"])("label",{for:"tel",class:"mb-2"},"電話",-1),L=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 配送資訊"),Object(a["i"])("span",{class:"text-danger fs-4 ms-2"},"(必填)")],-1),P={class:"mb-3 form-group"},$=Object(a["i"])("label",{for:"address",class:"mb-2"},"地址",-1),N={class:"mb-3 form-group"},A=Object(a["i"])("h4",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 留言"),Object(a["i"])("span",{class:"text-secondary fs-5 ms-2"},"(選填)")],-1),J=Object(a["i"])("label",{for:"message",class:"mb-2"},"留言",-1),z={class:"d-flex justify-content-end"},E=Object(a["h"])("繼續購物"),M={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},G=Object(a["h"])(" 送出訂單 ");Object(a["x"])();var H=n((function(e,t,c,H,K,R){var T,W,X,Y,Z,ee,te=Object(a["F"])("router-link"),ce=Object(a["F"])("Field"),ae=Object(a["F"])("ErrorMessage"),ne=Object(a["F"])("Form");return Object(a["w"])(),Object(a["e"])(a["a"],null,[s,Object(a["i"])("div",r,[Object(a["i"])("div",o,[l,0===(null===(T=H.carts.arr)||void 0===T||null===(W=T.carts)||void 0===W?void 0:W.length)?(Object(a["w"])(),Object(a["e"])("div",i,[u,Object(a["i"])(te,{to:"/frontDesk/products",class:"d-block text-orange fs-4"},{default:n((function(){return[b]})),_:1})])):(Object(a["w"])(),Object(a["e"])("table",d,[j,Object(a["i"])("tbody",null,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["D"])(H.carts.arr.carts,(function(t){return Object(a["w"])(),Object(a["e"])("tr",{key:t.id},[Object(a["i"])("td",null,[H.isLoading===t.id?(Object(a["w"])(),Object(a["e"])("button",O,[p,m])):(Object(a["w"])(),Object(a["e"])("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(c){return e.delProduct(t)}},[f],8,["onClick"]))]),Object(a["i"])("td",h,Object(a["I"])(t.product.title),1),Object(a["i"])("td",v,[Object(a["i"])("div",g,[Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:H.isChangeQty}],type:"button",onClick:function(c){return e.addQty(t)}}," + ",10,["onClick"]),Object(a["S"])(Object(a["i"])("input",{type:"number",class:"text-center form-control",min:"1",disabled:"","onUpdate:modelValue":function(e){return t.qty=e}},null,8,["onUpdate:modelValue"]),[[a["N"],t.qty,void 0,{number:!0}]]),Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:t.qty<=1||H.isChangeQty}],type:"button",onClick:function(c){return e.minusQty(t)}}," - ",10,["onClick"])])]),Object(a["i"])("td",y,"$ "+Object(a["I"])(H.currency(t.total)),1)])})),128))]),Object(a["i"])("tfoot",null,[Object(a["S"])(Object(a["i"])("tr",k,[x,Object(a["i"])("td",w," $ "+Object(a["I"])(H.currency(H.carts.arr.total-H.carts.arr.final_total)),1)],512),[[a["O"],H.carts.arr.total>H.carts.arr.final_total]]),Object(a["i"])("tr",null,[C,Object(a["i"])("td",V,"$ "+Object(a["I"])(H.currency(H.carts.arr.final_total)),1)])])])),0!=(null===(X=H.carts.arr)||void 0===X||null===(Y=X.carts)||void 0===Y?void 0:Y.length)?(Object(a["w"])(),Object(a["e"])("div",q,[Object(a["S"])(Object(a["i"])("input",{type:"text",class:"form-control",placeholder:"請輸入優惠券代碼","aria-label":"請輸入優惠券代碼","aria-describedby":"button-addon2","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.coupon=t})},null,512),[[a["N"],e.coupon]]),Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:""===e.coupon}],type:"button",id:"button-addon2",onClick:t[2]||(t[2]=function(){return e.useCoupon&&e.useCoupon.apply(e,arguments)})}," 套用優惠券 ",2)])):Object(a["f"])("",!0),0!=(null===(Z=H.carts.arr)||void 0===Z||null===(ee=Z.carts)||void 0===ee?void 0:ee.length)?(Object(a["w"])(),Object(a["e"])("div",S,[U,Object(a["i"])(ne,{onSubmit:e.onSubmit},{default:n((function(c){var s=c.errors;return[Object(a["i"])("div",_,[F,Object(a["i"])(ce,{id:"name",name:"聯絡人",type:"text",class:["form-control",{"is-invalid":s["聯絡人"]}],placeholder:"請輸入聯絡人",rules:"required",modelValue:e.user.user.name,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.user.user.name=t})},null,8,["class","modelValue"]),Object(a["i"])(ae,{name:"聯絡人",class:"invalid-feedback"})]),Object(a["i"])("div",Q,[I,Object(a["i"])(ce,{id:"email",name:"信箱",type:"email",class:["form-control",{"is-invalid":s["信箱"]}],placeholder:"請輸入信箱",rules:"email|required",modelValue:e.user.user.email,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.user.user.email=t})},null,8,["class","modelValue"]),Object(a["i"])(ae,{name:"信箱",class:"invalid-feedback"})]),Object(a["i"])("div",B,[D,Object(a["i"])(ce,{id:"tel",name:"電話",type:"tel",class:["form-control",{"is-invalid":s["電話"]}],placeholder:"請輸入電話",rules:e.isPhone,modelValue:e.user.user.tel,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.user.user.tel=t})},null,8,["class","rules","modelValue"]),Object(a["i"])(ae,{name:"電話",class:"invalid-feedback"})]),L,Object(a["i"])("div",P,[$,Object(a["i"])(ce,{id:"address",name:"地址",type:"text",class:["form-control",{"is-invalid":s["地址"]}],placeholder:"請輸入地址",rules:"required",modelValue:e.user.user.address,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.user.user.address=t})},null,8,["class","modelValue"]),Object(a["i"])(ae,{name:"地址",class:"invalid-feedback"})]),Object(a["i"])("div",N,[A,J,Object(a["S"])(Object(a["i"])("textarea",{class:"form-control",id:"message",placeholder:"有什麼話想對我們說呢?",rows:"3","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.message=t})},null,512),[[a["N"],e.message]])]),Object(a["i"])("div",z,[Object(a["i"])(te,{type:"button",class:"btn btn-secondary me-3",to:"/frontDesk/products"},{default:n((function(){return[E]})),_:1}),Object(a["i"])("button",{class:["btn btn-orange",{"not-allowed":Object.keys(e.user.user).length<4}],type:"submit"},["submit"===H.isLoading?(Object(a["w"])(),Object(a["e"])("span",M)):Object(a["f"])("",!0),G],2)])]})),_:1},8,["onSubmit"])])):Object(a["f"])("",!0)])])],64)})),K=c("5530"),R=(c("99af"),c("bc3a")),T=c.n(R),W=c("1336"),X=c("cfb9"),Y=c("98e4"),Z=c("6c02"),ee={setup:function(){var e=Object(Z["d"])(),t=Object(a["A"])({arr:[]}),c=Object(a["B"])(""),n=Object(a["B"])(!1);function s(){var e=Object(a["B"])(""),s=function(){var e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart");T.a.get(e).then((function(e){e.data.success?t.arr=e.data.data:console.error(e.data.message)})).catch((function(e){console.error(e)}))},r=function(e){c.value=e.id;var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart/").concat(e.id);T.a.delete(t).then((function(e){e.data.success?(X["a"].emit("update-cart"),s(),c.value=""):console.error(e.data.message),Object(Y["a"])(e,"刪除商品")})).catch((function(e){console.error(e)}))},o=function(e,t){n.value=!0;var c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart/").concat(t);T.a.put(c,{data:{product_id:t,qty:e}}).then((function(e){e.data.success?(n.value=!1,X["a"].emit("update-cart"),s()):console.error(e.data.message),Object(Y["a"])(e,"修改商品")})).catch((function(e){console.error(e)}))},l=function(){var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/coupon");T.a.post(t,{data:{code:e.value}}).then((function(e){e.data.success?(X["a"].emit("update-cart"),s()):console.error(e.data.message),Object(Y["a"])(e,"套用優惠券")})).catch((function(e){console.error(e)}))};return Object(a["t"])((function(){s()})),{coupon:e,getCarts:s,delProduct:r,editCart:o,useCoupon:l}}function r(){var e=s(),t=e.editCart,c=function(e){var c=e.qty+1;t(c,e.id)},a=function(e){var c=e.qty-1;t(c,e.id)};return{addQty:c,minusQty:a}}function o(){var t=Object(a["A"])({user:{}}),n=Object(a["B"])(""),s=function(e){var t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},r=function(){c.value="submit";var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/order");T.a.post(a,{data:{user:t.user,message:n.value}}).then((function(t){c.value="",t.data.success?(e.push("/frontDesk/pay/".concat(t.data.orderId)),X["a"].emit("update-cart")):console.error(t.data.message)})).catch((function(e){console.error(e)}))};return{user:t,message:n,isPhone:s,onSubmit:r}}return Object(K["a"])(Object(K["a"])(Object(K["a"])({carts:t,isChangeQty:n,isLoading:c,currency:W["a"]},s()),r()),o())}};c("d4cb");ee.render=H,ee.__scopeId="data-v-4b2e9600";t["default"]=ee},b0c0:function(e,t,c){var a=c("83ab"),n=c("9bf2").f,s=Function.prototype,r=s.toString,o=/^\s*function ([^ (]*)/,l="name";a&&!(l in s)&&n(s,l,{configurable:!0,get:function(){try{return r.call(this).match(o)[1]}catch(e){return""}}})},b9a7:function(e,t,c){},d4cb:function(e,t,c){"use strict";c("b9a7")}}]);
//# sourceMappingURL=chunk-f9e9ce84.420ed3a3.js.map