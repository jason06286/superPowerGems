(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d1a103ba"],{4438:function(e,t,c){"use strict";c.r(t);c("b0c0"),c("b64b");var a=c("7a23"),n=Object(a["U"])("data-v-7229cdc2");Object(a["z"])("data-v-7229cdc2");var r={class:"container bg-white",style:{"min-height":"calc(100vh - 112px)"}},s={class:"py-5"},o=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},"購屋車內容",-1),l={key:0,class:"cart-content"},i=Object(a["i"])("p",{class:"mb-0 fs-5"},"購物車內無東西",-1),u=Object(a["h"])("選購商品"),b={key:1,class:"table text-center table-responsive-lg"},d=Object(a["i"])("thead",null,[Object(a["i"])("tr",{class:"table-dark"},[Object(a["i"])("th",{scope:"col"}),Object(a["i"])("th",{scope:"col"},"商品名稱"),Object(a["i"])("th",{scope:"col",width:"120"},"數量"),Object(a["i"])("th",{scope:"col",class:"text-end"},"小計")])],-1),j={key:0,class:"btn btn-outline-danger btn-sm",type:"button",disabled:""},O=Object(a["i"])("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),p=Object(a["i"])("span",{class:"visually-hidden"},"Loading...",-1),m=Object(a["i"])("i",{class:"bi bi-trash-fill"},null,-1),f={class:"align-middle"},h={class:"align-middle"},v={class:"input-group input-group-sm"},g={class:"align-middle text-end"},y={class:"text-danger"},k=Object(a["i"])("td",{colspan:"3",class:"text-end"},"折扣優惠",-1),x={class:"line-through text-end"},w=Object(a["i"])("td",{colspan:"3",class:"text-end"},"總金額",-1),C={class:"text-end"},V={key:2,class:"mb-3 input-group"},q={key:3},S=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 收件人資訊"),Object(a["i"])("span",{class:"text-danger fs-4 ms-2"},"(必填)")],-1),U={class:"mb-3 form-group"},_=Object(a["i"])("label",{for:"name",class:"mb-2"},"聯絡人",-1),F={class:"mb-3 form-group"},Q=Object(a["i"])("label",{for:"email",class:"mb-2"},"信箱",-1),I={class:"mb-3 form-group"},B=Object(a["i"])("label",{for:"tel",class:"mb-2"},"電話",-1),D=Object(a["i"])("h2",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 配送資訊"),Object(a["i"])("span",{class:"text-danger fs-4 ms-2"},"(必填)")],-1),L={class:"mb-3 form-group"},P=Object(a["i"])("label",{for:"address",class:"mb-2"},"地址",-1),$={class:"mb-3 form-group"},N=Object(a["i"])("h4",{class:"pb-2 mb-3 border-3 border-bottom border-orange"},[Object(a["h"])(" 留言"),Object(a["i"])("span",{class:"text-secondary fs-5 ms-2"},"(選填)")],-1),A=Object(a["i"])("label",{for:"message",class:"mb-2"},"留言",-1),J={class:"d-flex justify-content-end"},z=Object(a["h"])("繼續購物"),E={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},M=Object(a["h"])(" 送出訂單 ");Object(a["x"])();var G=n((function(e,t,c,G,H,K){var R,T,W,X,Y,Z,ee=Object(a["F"])("router-link"),te=Object(a["F"])("Field"),ce=Object(a["F"])("ErrorMessage"),ae=Object(a["F"])("Form");return Object(a["w"])(),Object(a["e"])("div",r,[Object(a["i"])("div",s,[o,0===(null===(R=G.carts.arr)||void 0===R||null===(T=R.carts)||void 0===T?void 0:T.length)?(Object(a["w"])(),Object(a["e"])("div",l,[i,Object(a["i"])(ee,{to:"/frontDesk/products",class:"d-block text-orange fs-4"},{default:n((function(){return[u]})),_:1})])):(Object(a["w"])(),Object(a["e"])("table",b,[d,Object(a["i"])("tbody",null,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["D"])(G.carts.arr.carts,(function(t){return Object(a["w"])(),Object(a["e"])("tr",{key:t.id},[Object(a["i"])("td",null,[G.isLoading===t.id?(Object(a["w"])(),Object(a["e"])("button",j,[O,p])):(Object(a["w"])(),Object(a["e"])("button",{key:1,type:"button",class:"btn btn-outline-danger btn-sm",onClick:function(c){return e.delProduct(t)}},[m],8,["onClick"]))]),Object(a["i"])("td",f,Object(a["I"])(t.product.title),1),Object(a["i"])("td",h,[Object(a["i"])("div",v,[Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:G.isChangeQty}],type:"button",onClick:function(c){return e.addQty(t)}}," + ",10,["onClick"]),Object(a["S"])(Object(a["i"])("input",{type:"number",class:"text-center form-control",min:"1",disabled:"","onUpdate:modelValue":function(e){return t.qty=e}},null,8,["onUpdate:modelValue"]),[[a["N"],t.qty,void 0,{number:!0}]]),Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:t.qty<=1||G.isChangeQty}],type:"button",onClick:function(c){return e.minusQty(t)}}," - ",10,["onClick"])])]),Object(a["i"])("td",g,"$ "+Object(a["I"])(G.currency(t.total)),1)])})),128))]),Object(a["i"])("tfoot",null,[Object(a["S"])(Object(a["i"])("tr",y,[k,Object(a["i"])("td",x," $ "+Object(a["I"])(G.currency(G.carts.arr.total-G.carts.arr.final_total)),1)],512),[[a["O"],G.carts.arr.total>G.carts.arr.final_total]]),Object(a["i"])("tr",null,[w,Object(a["i"])("td",C,"$ "+Object(a["I"])(G.currency(G.carts.arr.final_total)),1)])])])),0!=(null===(W=G.carts.arr)||void 0===W||null===(X=W.carts)||void 0===X?void 0:X.length)?(Object(a["w"])(),Object(a["e"])("div",V,[Object(a["S"])(Object(a["i"])("input",{type:"text",class:"form-control",placeholder:"請輸入優惠券代碼","aria-label":"請輸入優惠券代碼","aria-describedby":"button-addon2","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.coupon=t})},null,512),[[a["N"],e.coupon]]),Object(a["i"])("button",{class:["btn btn-outline-secondary",{disabled:""===e.coupon}],type:"button",id:"button-addon2",onClick:t[2]||(t[2]=function(){return e.useCoupon&&e.useCoupon.apply(e,arguments)})}," 套用優惠券 ",2)])):Object(a["f"])("",!0),0!=(null===(Y=G.carts.arr)||void 0===Y||null===(Z=Y.carts)||void 0===Z?void 0:Z.length)?(Object(a["w"])(),Object(a["e"])("div",q,[S,Object(a["i"])(ae,{onSubmit:e.onSubmit},{default:n((function(c){var r=c.errors;return[Object(a["i"])("div",U,[_,Object(a["i"])(te,{id:"name",name:"聯絡人",type:"text",class:["form-control",{"is-invalid":r["聯絡人"]}],placeholder:"請輸入聯絡人",rules:"required",modelValue:e.user.user.name,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.user.user.name=t})},null,8,["class","modelValue"]),Object(a["i"])(ce,{name:"聯絡人",class:"invalid-feedback"})]),Object(a["i"])("div",F,[Q,Object(a["i"])(te,{id:"email",name:"信箱",type:"email",class:["form-control",{"is-invalid":r["信箱"]}],placeholder:"請輸入信箱",rules:"email|required",modelValue:e.user.user.email,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.user.user.email=t})},null,8,["class","modelValue"]),Object(a["i"])(ce,{name:"信箱",class:"invalid-feedback"})]),Object(a["i"])("div",I,[B,Object(a["i"])(te,{id:"tel",name:"電話",type:"tel",class:["form-control",{"is-invalid":r["電話"]}],placeholder:"請輸入電話",rules:e.isPhone,modelValue:e.user.user.tel,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.user.user.tel=t})},null,8,["class","rules","modelValue"]),Object(a["i"])(ce,{name:"電話",class:"invalid-feedback"})]),D,Object(a["i"])("div",L,[P,Object(a["i"])(te,{id:"address",name:"地址",type:"text",class:["form-control",{"is-invalid":r["地址"]}],placeholder:"請輸入地址",rules:"required",modelValue:e.user.user.address,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.user.user.address=t})},null,8,["class","modelValue"]),Object(a["i"])(ce,{name:"地址",class:"invalid-feedback"})]),Object(a["i"])("div",$,[N,A,Object(a["S"])(Object(a["i"])("textarea",{class:"form-control",id:"message",placeholder:"有什麼話想對我們說呢?",rows:"3","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.message=t})},null,512),[[a["N"],e.message]])]),Object(a["i"])("div",J,[Object(a["i"])(ee,{type:"button",class:"btn btn-secondary me-3",to:"/frontDesk/products"},{default:n((function(){return[z]})),_:1}),Object(a["i"])("button",{class:["btn btn-orange",{"not-allowed":Object.keys(e.user.user).length<4}],type:"submit"},["submit"===G.isLoading?(Object(a["w"])(),Object(a["e"])("span",E)):Object(a["f"])("",!0),M],2)])]})),_:1},8,["onSubmit"])])):Object(a["f"])("",!0)])])})),H=c("5530"),K=(c("99af"),c("bc3a")),R=c.n(K),T=c("1336"),W=c("cfb9"),X=c("98e4"),Y=c("6c02"),Z={setup:function(){var e=Object(Y["d"])(),t=Object(a["A"])({arr:[]}),c=Object(a["B"])(""),n=Object(a["B"])(!1);function r(){var e=Object(a["B"])(""),r=function(){var e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart");R.a.get(e).then((function(e){e.data.success?t.arr=e.data.data:console.error(e.data.message)})).catch((function(e){console.error(e)}))},s=function(e){c.value=e.id;var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart/").concat(e.id);R.a.delete(t).then((function(e){e.data.success?(W["a"].emit("update-cart"),r(),c.value=""):console.error(e.data.message),Object(X["a"])(e,"刪除商品")})).catch((function(e){console.error(e)}))},o=function(e,t){n.value=!0;var c="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/cart/").concat(t);R.a.put(c,{data:{product_id:t,qty:e}}).then((function(e){e.data.success?(n.value=!1,W["a"].emit("update-cart"),r()):console.error(e.data.message),Object(X["a"])(e,"修改商品")})).catch((function(e){console.error(e)}))},l=function(){var t="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/coupon");R.a.post(t,{data:{code:e.value}}).then((function(e){e.data.success?(W["a"].emit("update-cart"),r()):console.error(e.data.message),Object(X["a"])(e,"套用優惠券")})).catch((function(e){console.error(e)}))};return Object(a["t"])((function(){r()})),{coupon:e,getCarts:r,delProduct:s,editCart:o,useCoupon:l}}function s(){var e=r(),t=e.editCart,c=function(e){var c=e.qty+1;t(c,e.id)},a=function(e){var c=e.qty-1;t(c,e.id)};return{addQty:c,minusQty:a}}function o(){var t=Object(a["A"])({user:{}}),n=Object(a["B"])(""),r=function(e){var t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},s=function(){c.value="submit";var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("supergems","/order");R.a.post(a,{data:{user:t.user,message:n.value}}).then((function(t){c.value="",t.data.success?(e.push("/frontDesk/pay/".concat(t.data.orderId)),W["a"].emit("update-cart")):console.error(t.data.message)})).catch((function(e){console.error(e)}))};return{user:t,message:n,isPhone:r,onSubmit:s}}return Object(H["a"])(Object(H["a"])(Object(H["a"])({carts:t,isChangeQty:n,isLoading:c,currency:T["a"]},r()),s()),o())}};c("f242");Z.render=G,Z.__scopeId="data-v-7229cdc2";t["default"]=Z},"99f3":function(e,t,c){},b0c0:function(e,t,c){var a=c("83ab"),n=c("9bf2").f,r=Function.prototype,s=r.toString,o=/^\s*function ([^ (]*)/,l="name";a&&!(l in r)&&n(r,l,{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(e){return""}}})},f242:function(e,t,c){"use strict";c("99f3")}}]);
//# sourceMappingURL=chunk-d1a103ba.4d29001c.js.map